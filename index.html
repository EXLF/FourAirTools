<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FourAir社区撸毛工具箱</title>
    <!-- <link rel="stylesheet" href="styles.css"> -->
    <link rel="stylesheet" href="src/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- 可选: 引入图表库 -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <header class="navbar">
        <div class="logo">
            <i class="fa fa-space-shuttle"></i>
            <span>FourAir社区撸毛工具箱</span>
        </div>
        <div class="navbar-actions">
             <!-- 可添加全局搜索 -->
             <input type="search" placeholder="全局搜索..." class="global-search">
             <a href="#" class="action-item" title="通知">
                 <i class="fa fa-bell"></i>
                 <span class="badge">5</span>
             </a>
             <a href="#settings" class="action-item" title="设置" onclick="loadPage('settings')">
                 <i class="fa fa-cog"></i>
             </a>
             <a href="#" class="action-item account-menu-trigger" title="我的账户">
                <i class="fa fa-user-circle"></i>
                <!-- <span>用户昵称</span> -->
                <!-- 可添加下拉菜单 -->
             </a>
        </div>
    </header>

    <div class="main-container">
        <aside class="sidebar">
            <nav>
                <!-- 导航结构重组 -->
                <ul>
                    <li class="active"><a href="#dashboard"><i class="fas fa-tachometer-alt"></i> <span>仪表盘</span></a></li>
                </ul>
                 <h6><i class="fas fa-database"></i> 信息中心</h6>
                 <ul>
                    <li><a href="#projects"><i class="fas fa-rocket"></i> <span>项目跟踪</span></a></li>
                 </ul>
                 <h6><i class="fas fa-briefcase"></i> 资产 & 账户</h6>
                 <ul>
                    <li><a href="#wallets"><i class="fab fa-google-wallet"></i> <span>钱包管理</span></a></li>
                    <li><a href="#social"><i class="fas fa-users"></i> <span>社交账户</span></a></li>
                 </ul>
                 <h6><i class="fas fa-cogs"></i> 自动化工具</h6>
                 <ul>
                    <li><a href="#script-plugins"><i class="fas fa-plug"></i> <span>脚本插件</span></a></li>
                 </ul>
                 <h6><i class="fas fa-shield-alt"></i> 安全 & 网络</h6>
                 <ul>
                    <li><a href="#tool-network"><i class="fas fa-wifi"></i> <span>IP代理</span></a></li>
                 </ul>
                 <h6><i class="fas fa-graduation-cap"></i> 学习 & 社区</h6>
                 <ul>
                    <li><a href="#tutorials"><i class="fas fa-book"></i> <span>教程中心</span></a></li>
                    <li><a href="#community"><i class="fas fa-comments"></i> <span>社区交流</span></a></li>
                 </ul>
                 <h6><i class="fas fa-wrench"></i> 常用工具</h6>
                 <ul>
                     <li><a href="#tools"><i class="fas fa-wrench"></i> <span>工具链接</span></a></li>
                 </ul>
                 <h6><i class="fas fa-sliders-h"></i> 配置</h6>
                 <ul>
                    <li><a href="#settings"><i class="fas fa-cog"></i> <span>软件设置</span></a></li>
                 </ul>
            </nav>
            <div class="sidebar-footer">
                <span id="app-version">版本: 1.0.0-beta</span>
            </div>
        </aside>

        <main class="content-area">
            <!-- 内容区域将通过JavaScript动态加载 -->
        </main>
    </div>

    <!-- ========================== -->
    <!-- Modals -->
    <!-- ========================== -->

    <!-- Run Plugin Modal Template -->
    <template id="tpl-modal-run-plugin">
        <div class="modal-overlay">
            <div class="modal-box run-modal">
                <button class="modal-close-btn">&times;</button>
                <h3 class="modal-title">运行插件: <span id="run-plugin-name">Plugin Name</span></h3>
                <div class="modal-content">
                    <div class="run-config-section">
                        <h4>选择钱包</h4>
                        <div class="wallet-selection-compact-modal">
                             <div class="selection-actions">
                                <button class="btn-link">全选</button>
                                <button class="btn-link">反选</button>
                                <input type="search" placeholder="搜索钱包..." class="compact-search">
                            </div>
                            <div class="wallet-checkboxes-compact-modal">
                                <!-- Wallet checkboxes will be loaded here -->
                                <div class="wallet-cb-item"><input type="checkbox" id="m-cw1"><label for="m-cw1">0x1234...5678 (L0组)</label></div>
                                <div class="wallet-cb-item"><input type="checkbox" id="m-cw2"><label for="m-cw2">SubAcc_L0_01 (L0组)</label></div>
                                <div class="wallet-cb-item"><input type="checkbox" id="m-cw3"><label for="m-cw3">0xabcd...efgh (zkSync组)</label></div>
                                <div class="wallet-cb-item"><input type="checkbox" id="m-cw4"><label for="m-cw4">0xaaaa...bbbb</label></div>
                            </div>
                             <p>已选: <span id="modal-selected-wallet-count">0</span> 个钱包</p>
                        </div>
                    </div>
                     <div class="run-config-section">
                         <h4>执行设置</h4>
                         <div class="option-group inline">
                             <label>任务间隔(秒):</label>
                             <input type="number" value="30" min="1"> - <input type="number" value="60" min="1">
                             <input type="checkbox" id="modal-random-interval" checked><label for="modal-random-interval">随机</label>
                         </div>
                          <div class="option-group inline">
                             <label>Gas 策略:</label> <select><option>自动(推荐)</option><option>快速</option><option>省钱</option></select>
                         </div>
                    </div>
                    <div class="run-log-section">
                        <h4>执行日志</h4>
                        <div class="log-container modal-log-container">
                            <!-- Log entries will appear here -->
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary modal-cancel-btn">取消</button>
                    <button class="btn btn-success" id="modal-start-execution-btn"><i class="fa fa-play"></i> 开始执行</button>
                </div>
            </div>
        </div>
    </template>

    <!-- Config Plugin Modal Template -->
     <template id="tpl-modal-config-plugin">
        <div class="modal-overlay">
            <div class="modal-box config-modal">
                <button class="modal-close-btn">&times;</button>
                <h3 class="modal-title">配置插件: <span id="config-plugin-name">Plugin Name</span></h3>
                <div class="modal-content" id="config-options-area">
                    <!-- Configuration options will be loaded here based on plugin type -->
                    <p><em>(插件配置项加载区 - 待实现)</em></p>
                    <div class="option-group">
                        <label>示例配置项 A:</label>
                        <input type="text" placeholder="输入值...">
                    </div>
                     <div class="option-group">
                        <label>示例配置项 B:</label>
                        <select><option>选项1</option><option>选项2</option></select>
                    </div>
                     <div class="option-group">
                        <label>示例配置项 C:</label>
                        <input type="checkbox"> 启用此功能
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary modal-cancel-btn">取消</button>
                    <button class="btn btn-primary" id="modal-save-config-btn"><i class="fa fa-save"></i> 保存配置</button>
                </div>
            </div>
        </div>
    </template>

    <!-- ========= Wallet Form Modal Template ========== -->
    <template id="tpl-wallet-form">
        <div class="modal-overlay">
            <div class="modal-box wallet-form-modal">
                <button class="modal-close-btn">&times;</button>
                <h3 class="modal-title">钱包表单</h3>
                <div class="modal-content">
                    <form id="wallet-form-actual">
                        <input type="hidden" name="wallet-id" value=""> 

                        <!-- 只保留分组和备注 -->
                         <div class="option-group">
                            <label for="wallet-group">分组</label>
                            <select id="wallet-group" name="wallet-group">
                                <option value="">无分组</option>
                                <!-- 分组选项将由 JS 动态填充 -->
                            </select>
                        </div>
                         <div class="option-group">
                            <label for="wallet-notes">备注</label>
                            <input type="text" id="wallet-notes" name="wallet-notes" placeholder="关于此钱包的说明...">
                        </div>

                        <!-- 移除地址、名称、助记词、派生路径、私钥字段 -->

                    </form>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary modal-cancel-btn">取消</button>
                    <button type="submit" form="wallet-form-actual" class="btn btn-primary modal-save-btn">保存</button>
                </div>
            </div>
        </div>
    </template>

    <!-- ========= Manage Groups Modal Template ========== -->
    <template id="tpl-manage-groups">
        <div class="modal-overlay">
            <div class="modal-box manage-groups-modal">
                 <button class="modal-close-btn">&times;</button>
                 <h3 class="modal-title">管理分组</h3>
                 <div class="modal-content">
                     <h4>现有分组</h4>
                     <ul class="group-list" style="max-height: 200px; overflow-y: auto; margin-bottom: 15px; padding: 10px; border-radius: 4px;">
                         <!-- 分组列表将由 JS 动态填充 -->
                     </ul>
                      <h4>添加新分组</h4>
                      <div class="group-add-form option-group" style="margin-top: 10px;">
                          <input type="text" id="new-group-name" class="input" placeholder="输入新分组名称" style="flex: 1; min-width: 0;">
                          <button class="btn btn-success add-group-btn"><i class="fa fa-plus"></i> 添加</button>
                      </div>
                 </div>
                 <div class="modal-actions">
                     <button class="btn btn-secondary modal-close-btn-footer">关闭</button>
                 </div>
            </div>
        </div>
    </template>

    <!-- ========= NEW: Generate Wallets Modal Template ========== -->
    <template id="tpl-generate-wallets">
        <div class="modal-overlay">
            <div class="modal-box generate-wallets-modal">
                 <button class="modal-close-btn" title="关闭">&times;</button>
                 <h3 class="modal-title">批量生成钱包</h3>
                 <div class="modal-content">
                     <form id="generate-wallet-form">
                         <div class="option-group">
                             <label for="generate-count">生成数量 <span class="required">*</span></label>
                             <input type="number" id="generate-count" name="generate-count" required min="1" max="1000" value="10"> <!-- 添加最大值限制 -->
                         </div>
                         <div class="option-group">
                            <label for="generate-group">添加到分组 (可选)</label>
                            <select id="generate-group" name="generate-group">
                                <option value="">不指定分组</option>
                                <!-- 分组选项将由 JS 动态填充 -->
                            </select>
                        </div>
                        <div class="notice info">
                            <i class="fa fa-info-circle"></i> 将生成新的助记词和钱包。
                        </div>
                        <div id="generate-progress" style="margin-top: 15px; display: none;">
                             <progress value="0" max="100"></progress>
                             <span id="generate-progress-text"></span>
                         </div>
                     </form>
                 </div>
                 <div class="modal-actions">
                     <button class="btn btn-secondary modal-cancel-btn">取消</button>
                     <button type="submit" form="generate-wallet-form" class="btn btn-success modal-generate-btn"><i class="fa fa-cogs"></i> 开始生成</button>
                 </div>
            </div>
        </div>
    </template>

    <!-- ========= View Wallet Details Modal Template ========== -->
    <template id="tpl-view-wallet-details">
        <div class="modal-overlay">
            <div class="modal-box view-details-modal">
                 <button class="modal-close-btn" title="关闭">&times;</button>
                 <h3 class="modal-title">查看钱包详情</h3>
                 <div class="modal-content">
                     <div class="notice error" style="margin-bottom: 20px; padding: 12px; border-radius: 4px;">
                         <i class="fa fa-warning"></i> <strong>安全警告:</strong> 切勿向任何人泄露您的私钥或助记词！泄露可能导致资产永久丢失！
                     </div>
                     <!-- 使用 DL 结构 -->
                     <dl class="details-list">
                         <!-- 新增：钱包地址 -->
                         <dt>钱包地址:</dt>
                         <dd>
                             <div class="detail-value-container">
                                 <code id="view-wallet-address-value" class="sensitive-data">加载中...</code>
                                 <button class="btn-icon btn-icon-sm copy-btn" data-target="view-wallet-address-value" title="复制地址">
                                     <i class="fa fa-copy"></i>
                                 </button>
                             </div>
                         </dd>
                         <dt>私钥:</dt>
                         <dd>
                             <div class="detail-value-container">
                                 <code id="view-private-key" class="sensitive-data">加载中...</code>
                                 <button class="btn-icon btn-icon-sm copy-btn" data-target="view-private-key" title="复制私钥">
                                     <i class="fa fa-copy"></i>
                                 </button>
                             </div>
                         </dd>
                         <dt>助记词:</dt>
                         <dd>
                             <div class="detail-value-container">
                                 <code id="view-mnemonic" class="sensitive-data">加载中...</code>
                                 <button class="btn-icon btn-icon-sm copy-btn" data-target="view-mnemonic" title="复制助记词">
                                     <i class="fa fa-copy"></i>
                                 </button>
                             </div>
                         </dd>
                     </dl>
                 </div>
                 <div class="modal-actions">
                     <button class="btn btn-secondary modal-close-btn-footer">关闭</button>
                 </div>
            </div>
        </div>
    </template>

    <!-- ========= Social Account Form Modal Template ========== -->
    <template id="tpl-social-account-form">
        <div class="modal-overlay">
            <div class="modal-box social-account-form-modal">
                <button class="modal-close-btn">&times;</button>
                <h3 class="modal-title">添加社交账户</h3>
                <div class="modal-content">
                    <form id="social-account-form-actual">
                        <input type="hidden" name="account-id" value=""> <!-- 用于编辑模式 -->

                        <div class="option-group">
                            <label for="social-platform">平台 <span class="required">*</span></label>
                            <select id="social-platform" name="social-platform" required>
                                <option value="" disabled selected>请选择平台</option>
                                <option value="Twitter">Twitter</option>
                                <option value="Discord">Discord</option>
                                <option value="Telegram">Telegram</option>
                                <option value="Email">Email</option>
                                <!-- <option value="Other">其他</option> -->
                            </select>
                        </div>

                        <div class="option-group">
                            <label for="social-username">用户名/Handle <span class="required">*</span></label>
                            <input type="text" id="social-username" name="social-username" placeholder="例如 @username 或 user#1234" required>
                        </div>

                         <div class="option-group">
                            <label for="social-binding">绑定邮箱/手机</label>
                            <input type="text" id="social-binding" name="social-binding" placeholder="例如 xxx@email.com 或 +1 **** 1234">
                        </div>

                        <div class="option-group group-selection-group">
                            <label for="social-group">分组</label>
                            <div class="group-controls" style="display: flex; align-items: center; gap: 10px; width: 100%;">
                                <select id="social-group" name="social-group" style="flex: 1; min-width: 0;">
                                    <option value="">无分组</option>
                                    <!-- Options will be loaded by JS -->
                                </select>
                                <input type="text" class="new-group-name-input" placeholder="输入新分组" title="输入新分组名称，然后按回车键创建" style="width: 150px; flex-shrink: 0;">
                            </div>
                        </div>

                         <div class="option-group">
                            <label for="social-notes">备注</label>
                            <input type="text" id="social-notes" name="social-notes" placeholder="关于此账户的说明...">
                        </div>

                    </form>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary modal-cancel-btn">取消</button>
                    <button type="submit" form="social-account-form-actual" class="btn btn-primary modal-save-btn">保存</button>
                </div>
            </div>
        </div>
    </template>

    <!-- ========= NEW: Confirmation Dialog Modal Template ========== -->
    <template id="tpl-confirm-dialog">
        <div class="modal-overlay">
            <div class="modal-box confirm-modal" style="max-width: 450px;"> <!-- 可以调整宽度 -->
                 <button class="modal-close-btn" title="关闭">&times;</button>
                 <h3 class="modal-title">确认操作</h3>
                 <div class="modal-content">
                     <p class="confirm-message" style="margin-bottom: 20px; line-height: 1.6;">确认信息将显示在这里...</p>
                 </div>
                 <div class="modal-actions" style="justify-content: center;"> <!-- 按钮居中 -->
                     <button class="btn btn-secondary modal-cancel-btn" style="margin-right: 15px;">取消</button>
                     <button class="btn btn-danger modal-confirm-btn">确认</button> <!-- 使用危险色 -->
                 </div>
            </div>
        </div>
    </template>

    <!-- ========= NEW: Setup Password Modal Template ========== -->
    <template id="tpl-setup-password">
        <div class="modal-overlay">
            <div class="modal-box setup-password-modal">
                 <button class="modal-close-btn" title="关闭">&times;</button> <!-- Allow closing? Maybe not -->
                 <h3 class="modal-title">设置主密码</h3>
                 <div class="modal-content">
                     <p class="notice info"><i class="fa fa-info-circle"></i> 这是您首次启动应用，请设置一个强主密码以保护您的数据安全。此密码将用于加密您的钱包私钥等敏感信息。</p>
                     <form id="setup-password-form-actual">
                         <div class="option-group">
                             <label for="master-password">输入主密码 <span class="required">*</span></label>
                             <input type="password" id="master-password" name="master-password" required autocomplete="new-password">
                             <div class="password-strength-indicator">
                                 <div class="strength-bar"><div class="strength-meter"></div></div>
                                 <span class="strength-text"></span>
                             </div>
                         </div>
                         <div class="option-group">
                             <label for="confirm-password">确认主密码 <span class="required">*</span></label>
                             <input type="password" id="confirm-password" name="confirm-password" required autocomplete="new-password">
                         </div>
                         <div class="setup-password-error notice error" style="display: none;">错误信息</div>
                     </form>
                 </div>
                 <div class="modal-actions">
                     <!-- <button class="btn btn-secondary modal-cancel-btn">取消</button> --> <!-- Should not be cancellable -->
                     <button type="submit" form="setup-password-form-actual" class="btn btn-primary modal-setup-btn">设置密码并继续</button>
                 </div>
            </div>
        </div>
    </template>

    <!-- ========= NEW: Unlock Application Modal Template ========== -->
    <template id="tpl-unlock-app">
        <div class="modal-overlay unlock-overlay"> <!-- Add specific class for potential styling -->
            <div class="modal-box unlock-modal">
                 <!-- No close button - must unlock -->
                 <h3 class="modal-title"><i class="fa fa-lock"></i> 解锁应用</h3>
                 <div class="modal-content">
                     <p class="notice info">请输入您的主密码以解锁应用并访问您的数据。</p>
                     <form id="unlock-form-actual">
                         <div class="option-group">
                             <label for="unlock-password">主密码</label>
                             <input type="password" id="unlock-password" name="unlock-password" required autocomplete="current-password">
                         </div>
                         <div class="unlock-error notice error" style="display: none;">错误信息</div>
                         <!-- TODO: Add 'Forgot Password?' link/functionality later -->
                         <!-- <div style="text-align: right; margin-top: 10px;"><a href="#" class="link-forgot-password">忘记密码?</a></div> -->
                     </form>
                 </div>
                 <div class="modal-actions">
                     <button type="submit" form="unlock-form-actual" class="btn btn-primary modal-unlock-btn">
                         <i class="fa fa-unlock-alt"></i> 解锁
                     </button>
                 </div>
            </div>
        </div>
    </template>

    <!-- <script src="main.js"></script> -->
    <script type="module" src="src/js/core/app.js"></script>
    <div id="toast-container"></div> <!-- Toast container -->
</body>
</html> 